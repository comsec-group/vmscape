From f08018aee8f559042d22646c6867e11f7cee3120 Mon Sep 17 00:00:00 2001
From: JeanClaude Graf <jegraf@ee-tik-cn128.ethz.ch>
Date: Mon, 18 Aug 2025 14:28:54 +0200
Subject: [PATCH 3/3] Add uARF selftests

---
 tools/testing/selftests/kvm/Makefile.kvm        | 2 ++
 tools/testing/selftests/kvm/x86/exa_guest.c     | 1 +
 tools/testing/selftests/kvm/x86/exp_guest_bti.c | 1 +
 3 files changed, 4 insertions(+)
 create mode 120000 tools/testing/selftests/kvm/x86/exa_guest.c
 create mode 120000 tools/testing/selftests/kvm/x86/exp_guest_bti.c

diff --git a/tools/testing/selftests/kvm/Makefile.kvm b/tools/testing/selftests/kvm/Makefile.kvm
index 48aaf7de3d0c..82f9a702279f 100644
--- a/tools/testing/selftests/kvm/Makefile.kvm
+++ b/tools/testing/selftests/kvm/Makefile.kvm
@@ -148,6 +148,8 @@ TEST_GEN_PROGS_x86 += rseq_test
 TEST_GEN_PROGS_x86 += steal_time
 TEST_GEN_PROGS_x86 += system_counter_offset_test
 TEST_GEN_PROGS_x86 += pre_fault_memory_test
+TEST_GEN_PROGS_x86 += x86/exa_guest
+TEST_GEN_PROGS_x86 += x86/exp_guest_bti
 
 # Compiled outputs used by test targets
 TEST_GEN_PROGS_EXTENDED_x86 += x86/nx_huge_pages_test
diff --git a/tools/testing/selftests/kvm/x86/exa_guest.c b/tools/testing/selftests/kvm/x86/exa_guest.c
new file mode 120000
index 000000000000..6254f260e72c
--- /dev/null
+++ b/tools/testing/selftests/kvm/x86/exa_guest.c
@@ -0,0 +1 @@
+../../../../../../selftests/exa_guest.c
\ No newline at end of file
diff --git a/tools/testing/selftests/kvm/x86/exp_guest_bti.c b/tools/testing/selftests/kvm/x86/exp_guest_bti.c
new file mode 120000
index 000000000000..b995c350d651
--- /dev/null
+++ b/tools/testing/selftests/kvm/x86/exp_guest_bti.c
@@ -0,0 +1 @@
+../../../../../../selftests/exp_guest_bti.c
\ No newline at end of file
-- 
2.51.0

